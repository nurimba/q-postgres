!function(e){function t(n){if(r[n])return r[n].exports;var u=r[n]={exports:{},id:n,loaded:!1};return e[n].call(u.exports,u,u.exports,t),u.loaded=!0,u.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.orm=void 0;var u=r(9),a=n(u),i=r(3),o=n(i),l=r(2),f=n(l),c=r(22),d=r(10),s=n(d),v="BEGIN",p="COMMIT",b="ROLLBACK",g=function(){var e=(0,f["default"])(o["default"].mark(function t(e){var r,n;return o["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connect();case 2:if(r=t.sent,n=r.errno,!n){t.next=6;break}throw new Error(r.message);case 6:return t.abrupt("return",r);case 7:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}(),h=function(e,t){return new a["default"](function(r,n){e.query(t,function(e,t){return e?n(e):void r(t)})})},_=function(){var e=(0,f["default"])(o["default"].mark(function t(e){var r;return o["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g(e);case 2:return r=t.sent,t.abrupt("return",{release:function(){var e=(0,f["default"])(o["default"].mark(function t(){return o["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.release());case 1:case"end":return e.stop()}},t,void 0)}));return function(){return e.apply(this,arguments)}}(),execute:h.bind(void 0,r),commit:h.bind(void 0,r,p),rollback:h.bind(void 0,r,b),startTransaction:h.bind(void 0,r,v)});case 4:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}();t.orm=s["default"];t["default"]=function(e){var t=new c.Pool(e),r=_.bind(void 0,t);return{connect:r}}},function(e,t){e.exports=require("babel-runtime/core-js/object/assign")},function(e,t){e.exports=require("babel-runtime/helpers/asyncToGenerator")},function(e,t){e.exports=require("babel-runtime/regenerator")},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.objToListFields=t.fieldIsString=t.blankLine=t.breakLine=void 0;var u=r(6),a=n(u),i=t.breakLine="\n";t.blankLine=""+i+i,t.fieldIsString=function(e,t){return Boolean(e.find(function(e){var r=e.field,n=e.type;return t===r&&Boolean(n===String||n===Date)}))},t.objToListFields=function(e){var t=e.fields;return(0,a["default"])(t).map(function(e){var r=t[e].type;return{type:r,field:e}})}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(3),a=n(u),i=r(20),o=n(i),l=r(1),f=n(l),c=r(6),d=n(c),s=r(9),v=n(s),p=r(2),b=n(p);t["default"]=function(){var e=(0,b["default"])(a["default"].mark(function t(e,r,n){var u,i,l=e.fields,c=r.execute;return a["default"].wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(n);case 2:return u=e.sent,i=u.rows,e.next=6,v["default"].all(i.map(function(){var e=(0,b["default"])(a["default"].mark(function t(e){var r;return a["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={},(0,d["default"])(l).forEach(function(t){var n=e[t],u=l[t].type;if(u===Date){var a=new Date(n),i=("0"+a.getDate()).substring(-2),c=("0"+(a.getMonth()+1)).substring(-2);n=n?a.getFullYear()+"-"+c+"-"+i:null}u===String&&(n=String(n||"")),u===Boolean&&(n=Boolean(n)),(0,f["default"])(r,(0,o["default"])({},t,n))}),t.abrupt("return",r);case 3:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}()));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},t,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()},function(e,t){e.exports=require("babel-runtime/core-js/object/keys")},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(8),a=n(u),i=r(4),o=function(e){for(var t=e.table,r=e.selectFields,n=e.conditional,u=e.limitRows,a=e.orderFields,o=e.joinTables,l=e.groupFields,f="\nSELECT "+r+"\nFROM "+t+"\n"+o+"\n"+n+"\n"+l+"\n"+a+"\n"+u+"\n";f.indexOf(i.blankLine)!==-1;)f=f.replace(i.blankLine,i.breakLine);return f.trim()},l=function(e){var t=e.limit,r=e.page;if(!t)return"";if(!r)return"LIMIT "+t;var n=(r-1)*t;return n?"LIMIT "+t+" OFFSET "+n:"LIMIT "+t},f=function(e){var t=e.table,r=e.select,n=e.orderBy,u=e.count;if(!n)return"";var a=n.map(function(e){var n=e.field,a=e.order,i=e.table||t,o=r.find(function(e){var r=e.field,u=e.table||t;return r===n&&u===i});if(!o)return(i+"."+n+" "+(a||"")).trim();var l=r.indexOf(o)+1;return u&&l++,(l+" "+(a||"")).trim()}).join(", ");return a?"ORDER BY "+a:""},c=function(e){var t=e.joins;return t?t.map(function(e){var t="string"==typeof e;if(t)return e;var r=e.tableRef,n=e.fieldRef,u=e.tableLink,a=e.fieldLink;return"JOIN "+r+" ON ("+r+"."+n+" = "+u+"."+a+")"}).join(i.breakLine):""},d=function(e,t){var r=e.grouping,n=t.select,u=t.func;return(!r||!u)&&(void 0===n||Boolean(n))},s=function(e,t,r){var n=t[0].toUpperCase().concat(t.substring(1,t.length));return r?r+"("+e+"."+t+") AS "+r.toLowerCase()+n:e+"."+t},v=function(e,t,r){var n=t[0].toUpperCase().concat(t.substring(1,t.length));if(r){var u=e[0].toUpperCase().concat(e.substring(1,e.length));return r+"("+e+"."+t+") AS "+r.toLowerCase()+u+n}return e+"."+t+" AS "+e+n},p=function(e){var t=e.select;return t.filter(d.bind(void 0,e)).map(function(t){var r=e.table,n=e.grouping,u=t.field,a=t.func,i=t.table||r;return n?i+"."+u:i===r?s(i,u,a):v(i,u,a)})},b=function(e){var t=e.table,r=e.select,n=e.count,u=e.distinct;u&&n&&(u=!1);var a=p({select:r,table:t}).join(", ");return n?"COUNT(-1) AS _counter"+(a?", ".concat(a):""):u?"DISTINCT "+a:a},g=function(e){var t=e.select,r=e.table,n=e.count;if(!t)return"";var u=!0,a=p({select:t,table:r,grouping:u}).join(", "),i=Boolean(t.find(function(e){var t=e.func;return Boolean(t)})),o=(n||i)&&a;return o?"GROUP BY "+a:""};t["default"]=function(e){var t=e.table,r=e.select,n=e.where,u=e.distinct,i=e.limit,d=e.page,s=e.orderBy,v=e.joins,p=e.count,h=b({table:t,select:r,count:p,distinct:u}),_=f({table:t,select:r,orderBy:s,count:p}),m=c({joins:v}),w=(0,a["default"])({select:r,where:n,table:t}),j=l({limit:i,page:d}),y=g({select:r,table:t,count:p});return o({table:t,selectFields:h,conditional:w,limitRows:j,orderFields:_,joinTables:m,groupFields:y})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),u=function a(e){var t=e.where,r=e.select,u=e.table;return t.map(function(e){var t=e.field,i=e.comparator,o=e.value,l=e.or,f=e.and;if(l){var c=a({where:l,select:r,table:u}).join(")"+n.breakLine+"    OR (");return c?"("+c+")":""}if(f){var d=a({where:f,select:r,table:u}).join(")"+n.breakLine+"   AND (");return d?"("+d+")":""}var s=e.table||u,v=(0,n.fieldIsString)(r,t),p=v?"'"+String(o).replace("'","\\'")+"'":o;return s+"."+t+" "+i+" "+p})};t["default"]=function(e){var t=e.where,r=e.select,a=e.table;if(!t)return"";var i=u({where:t,select:r,table:a}).join(")"+n.breakLine+"  AND (");return i?"WHERE ("+i+")":""}},function(e,t){e.exports=require("babel-runtime/core-js/promise")},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(1),a=n(u),i=r(12),o=n(i),l=r(14),f=n(l),c=r(16),d=n(c),s=r(13),v=n(s),p=r(15),b=n(p),g=r(11),h=n(g);t["default"]=function(e){return function(t){var r={joins:[],create:o["default"].bind(void 0,e,t),findById:f["default"].bind(void 0,e,t),deleteById:v["default"].bind(void 0,e,t),updateById:d["default"].bind(void 0,e,t),findByQuery:function(n){return(0,b["default"])((0,a["default"])({},e,{joins:r.joins}),t,n)},countByQuery:function(n){return(0,h["default"])((0,a["default"])({},e,{joins:r.joins}),t,n)},join:function(e){return r.joins.push(e),r}};return r}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(3),a=n(u),i=r(1),o=n(i),l=r(2),f=n(l),c=r(6),d=n(c),s=r(5),v=n(s),p=r(7),b=n(p),g={eq:"=",lt:"<",gt:">",lq:"<=",gq:">=",df:"<>",lk:"like"},h=function(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return(0,d["default"])(e).forEach(function(r){var n=void 0,u=e[r],a="=",i=u.split(":");if(2===i.length){var o=String(i[0]).toLowerCase().trim();g.hasOwnProperty(o)&&(u=String(i[1]).trim(),a=g[o],"like"===a&&(u="%"+u+"%"))}var l=r.split(".");2===l.length&&(n=String(l[0]).trim(),r=String(l[1]).trim()),t.push({field:r,comparator:a,value:u,table:n})}),t};t["default"]=function(){var e=(0,f["default"])(a["default"].mark(function t(e,r,n){var u,i,l,f;return a["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u=h(n),i=(0,b["default"])((0,o["default"])({},e,{where:u,count:!0})),t.next=4,(0,v["default"])(e,r,i);case 4:return l=t.sent,f=l.rows,t.abrupt("return",f.pop()._counter);case 7:case"end":return t.stop()}},t,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(3),a=n(u),i=r(1),o=n(i),l=r(21),f=n(l),c=r(2),d=n(c),s=r(5),v=n(s),p=r(18),b=n(p);t["default"]=function(){var e=(0,d["default"])(a["default"].mark(function t(e,r,n){var u,i,l;return a["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u=(0,f["default"])({},n),i=(0,b["default"])((0,o["default"])({},e,{data:u})),t.next=4,(0,v["default"])(e,r,i);case 4:return l=t.sent,t.abrupt("return",l.pop());case 6:case"end":return t.stop()}},t,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(3),a=n(u),i=r(1),o=n(i),l=r(2),f=n(l),c=r(5),d=n(c),s=r(17),v=n(s);t["default"]=function(){var e=(0,f["default"])(a["default"].mark(function t(e,r,n){var u,i;return a["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u=[{field:"id",comparator:"=",value:n}],i=(0,v["default"])((0,o["default"])({},e,{where:u})),t.abrupt("return",(0,d["default"])(e,r,i));case 3:case"end":return t.stop()}},t,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(3),a=n(u),i=r(1),o=n(i),l=r(2),f=n(l),c=r(5),d=n(c),s=r(7),v=n(s),p=r(4);t["default"]=function(){var e=(0,f["default"])(a["default"].mark(function t(e,r,n){var u,i,l,f;return a["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u=(0,p.objToListFields)(e),i=[{field:"id",comparator:"=",value:n}],l=(0,v["default"])((0,o["default"])({},e,{select:u,where:i})),t.next=5,(0,d["default"])(e,r,l);case 5:return f=t.sent,t.abrupt("return",f.pop());case 7:case"end":return t.stop()}},t,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(3),a=n(u),i=r(1),o=n(i),l=r(2),f=n(l),c=r(6),d=n(c),s=r(5),v=n(s),p=r(7),b=n(p),g=r(4),h={eq:"=",lt:"<",gt:">",lq:"<=",gq:">=",df:"<>",lk:"like"},_=function(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return(0,d["default"])(e).forEach(function(r){var n=void 0,u=e[r],a="=",i=u.split(":");if(2===i.length){var o=String(i[0]).toLowerCase().trim();h.hasOwnProperty(o)&&(u=String(i[1]).trim(),a=h[o],"like"===a&&(u="%"+u+"%"))}var l=r.split(".");2===l.length&&(n=String(l[0]).trim(),r=String(l[1]).trim()),t.push({field:r,comparator:a,value:u,table:n})}),t};t["default"]=function(){var e=(0,f["default"])(a["default"].mark(function t(e,r,n){var u,i,l;return a["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u=_(n),i=(0,g.objToListFields)(e),l=(0,b["default"])((0,o["default"])({},e,{select:i,where:u})),t.abrupt("return",(0,v["default"])(e,r,l));case 4:case"end":return t.stop()}},t,void 0)}));return function(t,r,n){return e.apply(this,arguments)}}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(3),a=n(u),i=r(1),o=n(i),l=r(2),f=n(l),c=r(5),d=n(c),s=r(19),v=n(s);t["default"]=function(){var e=(0,f["default"])(a["default"].mark(function t(e,r,n,u){var i,l,f;return a["default"].wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=[{field:"id",comparator:"=",value:n}],l=(0,v["default"])((0,o["default"])({},e,{data:u,where:i})),t.next=4,(0,d["default"])(e,r,l);case 4:return f=t.sent,t.abrupt("return",f.pop());case 6:case"end":return t.stop()}},t,void 0)}));return function(t,r,n,u){return e.apply(this,arguments)}}()},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(8),a=n(u),i=r(4),o=function(e){var t=e.table,r=e.conditional;return("\nDELETE FROM "+t+"\n"+r+";\n").trim()};t["default"]=function(e){var t=e.table,r=e.fields,n=e.where,u=(0,i.objToListFields)({fields:r}),l=(0,a["default"])({select:u,where:n,table:t});return o({table:t,conditional:l})}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(6),a=n(u),i=r(4),o=function(e){var t=e.data;return(0,a["default"])(t).filter(f.bind(void 0,t)).join(", ")},l=function(e){var t=e.fields;return(0,a["default"])(t).join(", ")},f=function(e,t){var r=e[t];return void 0!==r&&null!==r},c=function(e){var t=e.fields,r=e.data,n=(0,i.objToListFields)({fields:t});return(0,a["default"])(r).filter(f.bind(void 0,r)).map(function(e){var t=r[e],u=(0,i.fieldIsString)(n,e);return u?"'"+String(t).replace("'","\\'")+"'":t}).join(", ")},d=function(e){var t=e.table,r=e.listFields,n=e.listValues,u=e.listReturning;return("\nINSERT INTO "+t+" ("+r+")\n       VALUES ("+n+")\n       RETURNING "+u+";\n").trim()};t["default"]=function(e){var t=e.table,r=e.fields,n=e.data,u=o({data:n}),a=c({fields:r,data:n}),i=l({fields:r});return d({table:t,listFields:u,listValues:a,listReturning:i})}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(6),a=n(u),i=r(8),o=n(i),l=r(4),f=function(e){var t=e.fields;return(0,a["default"])(t).join(", ")},c=function(e,t){var r=e[t];return void 0!==r},d=function(e){var t=e.select,r=e.data;return(0,a["default"])(r).filter(c.bind(void 0,r)).map(function(e){var n=r[e];if(null===n)return e+" = null";var u=(0,l.fieldIsString)(t,e);return u?e+" = '"+String(n).replace("'","\\'")+"'":e+" = "+n}).join(","+l.breakLine+"      ")},s=function(e){var t=e.table,r=e.setters,n=e.conditional,u=e.listReturning;return("\nUPDATE "+t+"\n  SET "+r+"\n  "+n+"\n  RETURNING "+u+";\n").trim()};t["default"]=function(e){var t=e.table,r=e.fields,n=e.data,u=e.where,a=(0,l.objToListFields)({fields:r}),i=d({select:a,data:n}),c=f({fields:r}),v=(0,o["default"])({select:a,where:u,table:t});return s({table:t,setters:i,conditional:v,listReturning:c})}},function(e,t){e.exports=require("babel-runtime/helpers/defineProperty")},function(e,t){e.exports=require("babel-runtime/helpers/extends")},function(e,t){e.exports=require("pg")}]);
//# sourceMappingURL=q-postgres.js.map